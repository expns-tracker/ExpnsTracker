<!DOCTYPE html>
<html lang="en"
      xmlns:th="http://www.thymeleaf.org"
      xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
      layout:decorate="~{fragments/layout}">
<head>
    <title>Edit Transaction</title>
</head>
<body>

<div layout:fragment="content">
    <div class="container" style="margin-top: 40px;">
        <div class="row">
            <div class="col s12 m8 offset-m2 l6 offset-l3">

                <div class="card hoverable z-depth-2">
                    <div class="card-content">
                        <span class="card-title center blue-text text-darken-2">
                            Edit Transaction
                        </span>

                        <form th:action="@{/transactions/edit/{id}(id=${transaction.id})}" th:object="${transaction}" method="post" style="margin-top: 30px;">

                            <input type="hidden" th:field="*{id}" />
                            <input type="hidden"  th:field="*{userId}" />

                            <!-- Transaction Type -->
                            <div class="input-field">
                                <i class="material-icons prefix grey-text">swap_horiz</i>
                                <select th:field="*{type}" required>
                                    <option th:each="type : ${types}"
                                            th:value="${type}"
                                            th:text="${type}">
                                    </option>
                                </select>
                                <label>Transaction Type</label>
                            </div>

                            <!-- Category Selection -->
                            <div class="input-field">
                                <i class="material-icons prefix grey-text">category</i>
                                <select th:field="*{categoryId}" required>
                                    <!-- Iterate over the Map (Key=ID, Value=Name) provided by Controller -->
                                    <option th:each="entry : ${categoriesMap}"
                                            th:value="${entry.key}"
                                            th:text="${entry.value}"
                                            th:selected="${entry.key == transaction.categoryId}">
                                        Food & Drinks
                                    </option>
                                </select>
                                <label>Category</label>
                            </div>

                            <!-- Amount -->
                            <div class="input-field">
                                <i class="material-icons prefix grey-text">attach_money</i>
                                <input id="amount" type="number" step="0.01"
                                       th:value="${transaction.amount}"
                                       name="amount"
                                       required class="validate">
                                <label for="amount" class="active">Amount</label>
                            </div>

                            <!-- Description -->
                            <div class="input-field">
                                <i class="material-icons prefix grey-text">description</i>
                                <textarea id="description" th:field="*{description}" class="materialize-textarea"></textarea>
                                <label for="description" class="active">Description</label>
                            </div>

                            <div class="card-action center-align" style="border-top: none; padding-top: 20px;">
                                <button class="btn waves-effect waves-light blue darken-1 z-depth-1" type="submit">
                                    Update Transaction
                                    <i class="material-icons right">update</i>
                                </button>
                                <br><br>
                                <a th:href="@{/transactions}" class="grey-text">Cancel</a>
                            </div>

                        </form>
                    </div>
                </div>

            </div>
        </div>
    </div>
</div>

</body>
</html>